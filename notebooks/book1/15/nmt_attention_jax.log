An error occurred while executing the following cell:
------------------
encoder = Seq2SeqEncoder(vocab_size=10, embed_size=8, num_hiddens=16, num_layers=2)
decoder = Seq2SeqAttentionDecoder(vocab_size=10, embed_size=8, num_hiddens=16, num_layers=2)
X = jnp.zeros((4, 7), dtype=jnp.int32)  # (`batch_size`, `num_steps`)
encoder_params = encoder.init(rng, X)
state = decoder.init_state(encoder.apply(encoder_params, X), None)
decoder_params = decoder.init(rng, state, X)
state, output = decoder.apply(decoder_params, state, X)
output.shape, len(state), state[1].shape, len(state[0]), state[0][0].shape
------------------

---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
/tmp/ipykernel_1812/2826652833.py in <module>
      2 decoder = Seq2SeqAttentionDecoder(vocab_size=10, embed_size=8, num_hiddens=16, num_layers=2)
      3 X = jnp.zeros((4, 7), dtype=jnp.int32)  # (`batch_size`, `num_steps`)
----> 4 encoder_params = encoder.init(rng, X)
      5 state = decoder.init_state(encoder.apply(encoder_params, X), None)
      6 decoder_params = decoder.init(rng, state, X)

    [... skipping hidden 11 frame]

/tmp/ipykernel_1812/3945077378.py in __call__(self, X, deterministic, *args)
     16         rnn = GRU(num_layers=self.num_layers, dropout_rate=self.dropout_rate, deterministic=deterministic)
     17         state = rnn.initialize_carry(jax.random.PRNGKey(0), (X.shape[1],), self.num_hiddens)
---> 18         state, output = rnn(state, X)
     19         # `state` shape: (`num_layers`, `batch_size`, `num_hiddens`)
     20         # `output` shape: (`num_steps`, `batch_size`, `num_hiddens`)

    [... skipping hidden 4 frame]

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/core/axes_scan.py in scan_fn(broadcast_in, init, *args)
    133         lu.wrap_init(broadcast_body), in_tree)
    134     in_pvals = list(map(pe.PartialVal.unknown, in_avals))
--> 135     _, out_pvals, _ = pe.trace_to_jaxpr(f_flat, in_pvals)
    136 
    137     out_flat = []

    [... skipping hidden 4 frame]

~/miniconda3/envs/py37/lib/python3.7/site-packages/jax/interpreters/partial_eval.py in tracers_to_jaxpr(in_tracers, out_tracers)
    744       t_to_var[id(t)] = recipe
    745     elif recipe is None:
--> 746       assert False
    747     else:
    748       raise TypeError(recipe)

AssertionError: 
AssertionError: 
